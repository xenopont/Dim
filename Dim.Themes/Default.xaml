<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:system="clr-namespace:System;assembly=System.Runtime">
    <SolidColorBrush x:Key="OverlappedWindowBackgroundBrush" Color="#FFd4d0c7" />
    <CornerRadius x:Key="OverlappedWindowCornerRadius">0</CornerRadius>
    <system:Double x:Key="OverlappedWindowTitleHeight">24</system:Double>
    <LinearGradientBrush x:Key="OverlappedWindowTitleBrush" StartPoint="0,0" EndPoint="1,0">
        <LinearGradientBrush.GradientStops>
            <GradientStop Offset="0" Color="#FF004488" />
            <GradientStop Offset="1" Color="#FF0088CC" />
        </LinearGradientBrush.GradientStops>
    </LinearGradientBrush>
    <Thickness x:Key="ShadowMargin">0,0,8,8</Thickness>
    <!-- Window Title Button Template -->
    <ControlTemplate TargetType="Button" x:Key="OverlappedWindowTitleButton">
        <ContentControl FontSize="9" FontWeight="Bold" FlowDirection="LeftToRight">
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal" />
                    <VisualState x:Name="Pressed">
                        <Storyboard>
                            <ColorAnimation Storyboard.TargetName="OuterBorder"
                                            Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)"
                                            To="#44000000" Duration="0:0:0.05" />
                            <ThicknessAnimation Storyboard.TargetName="ContentBorder"
                                                Storyboard.TargetProperty="(Border.Margin)"
                                                To="5,5,4,4" Duration="0:0:0.05" />
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="MouseOver" />
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
            <Grid Background="{DynamicResource OverlappedWindowBackgroundBrush}"
                  Width="21"
                  Height="20">
                <Border x:Name="OuterBorder" BorderBrush="#FFFFFFFF" BorderThickness="1,1,0,0">
                    <Border BorderBrush="#CC000000" BorderThickness="0,0,1,1">
                        <Border BorderBrush="#88000000" BorderThickness="0,0,1,1" />
                    </Border>
                </Border>
                <Border x:Name="ContentBorder" Margin="4,4,5,5">
                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
            </Grid>
        </ContentControl>
    </ControlTemplate>

    <ControlTemplate TargetType="Window" x:Key="OverlappedWindowControlTemplate">
        <ContentControl>
            <Grid>
                <!-- Shadow -->
                <Border Background="#44000000" Margin="4">
                    <Border.Effect>
                        <BlurEffect Radius="4" KernelType="Gaussian" RenderingBias="Quality" />
                    </Border.Effect>
                </Border>
                <!-- Window Background and Border -->
                <Border Margin="{DynamicResource ShadowMargin}"
                        Background="{DynamicResource OverlappedWindowBackgroundBrush}">
                    <Border BorderBrush="#88FFFFFF" BorderThickness="1,1,0,0">
                        <Border BorderBrush="#CC000000" BorderThickness="0,0,1,1">
                            <Border BorderBrush="#FFFFFFFF" BorderThickness="1,1,0,0">
                                <Border BorderBrush="#FF000000" BorderThickness="0,0,1,1">
                                    <Border BorderBrush="#44FFFFFF" BorderThickness="1,1,0,0">
                                        <Border BorderBrush="#44000000" BorderThickness="0,0,1,1" />
                                    </Border>
                                </Border>
                            </Border>
                        </Border>
                    </Border>
                </Border>
                <!-- Window Title -->
                <Grid Height="{DynamicResource OverlappedWindowTitleHeight}"
                      Margin="4,4,12,12"
                      Background="{DynamicResource OverlappedWindowTitleBrush}"
                      VerticalAlignment="Top">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="16" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="2" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="2" />
                    </Grid.ColumnDefinitions>
                    <ContentPresenter Content="{TemplateBinding Icon}"
                                      Width="16" Height="16"
                                      Grid.Column="0" />
                    <TextBlock Text="{TemplateBinding Title}" Grid.Column="1"
                               VerticalAlignment="Center" FontWeight="Bold"
                               Foreground="#FFFFFFFF" />
                    <!-- Minimize Button -->
                    <Button Grid.Column="3" Template="{StaticResource OverlappedWindowTitleButton}"
                            HorizontalAlignment="Left">
                        <Viewbox Stretch="Fill">
                            <Canvas Width="10" Height="10">
                                <Path Stroke="#FF000000"
                                      StrokeThickness="2"
                                      Data="M0,9 L9,9" />
                            </Canvas>
                        </Viewbox>
                    </Button>
                    <!-- Maximize Button -->
                    <Button Grid.Column="4"
                            Template="{StaticResource OverlappedWindowTitleButton}"
                            HorizontalAlignment="Left"
                            Visibility="Collapsed">
                        <Viewbox Stretch="Fill">
                            <Canvas Width="10" Height="10">
                                <Path Stroke="#FF000000"
                                      StrokeThickness="1"
                                      Data="M10,0 L0,0 L0,10 L10,10 Z M0,1 L10,1" />
                            </Canvas>
                        </Viewbox>
                    </Button>
                    <!-- Restore Button -->
                    <Button Grid.Column="4"
                            Template="{StaticResource OverlappedWindowTitleButton}"
                            HorizontalAlignment="Left"
                            Visibility="Visible">
                        <Viewbox Stretch="Fill">
                            <Canvas Width="10" Height="10">
                                <Path Stroke="#FF000000"
                                      StrokeThickness="1"
                                      Data="M7,6 L9,6 L9,0 L3,0 L3,3 M3,1 L9,1 M0,4 L6,4 L6,9 L0,9 Z M0,5 L6,5" />
                            </Canvas>
                        </Viewbox>
                    </Button>
                    <!-- Close Button -->
                    <Button Grid.Column="6"
                            Template="{StaticResource OverlappedWindowTitleButton}"
                            HorizontalAlignment="Left">
                        <Viewbox Stretch="Fill">
                            <Canvas Width="16" Height="16">
                                <Path Stroke="#FF000000"
                                      StrokeThickness="1"
                                      Data="M0,0 L16,16 M16,0 L0,16" />
                            </Canvas>
                        </Viewbox>
                    </Button>
                </Grid>
                <!-- Content Container -->
                <Border Margin="4,26,12,4" Padding="4">
                    <ContentPresenter />
                </Border>
            </Grid>
        </ContentControl>
    </ControlTemplate>

    <Style x:Key="OverlappedWindowStyle" TargetType="Window">
        <Style.Setters>
            <Setter Property="Template" Value="{DynamicResource OverlappedWindowControlTemplate}" />
        </Style.Setters>
    </Style>
</ResourceDictionary>